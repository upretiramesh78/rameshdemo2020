node {
    def mvn = tool (name: 'maven3', type: 'maven') + '/bin/mvn'
   stage('SCM Checkout'){
    // Clone repo
	git branch: 'master', 
	credentialsId: 'github', 
	url: 'https://github.com/upretiramesh78/rameshdemo2020/'
      }
   
stage('Build & Compile') {    
   def mvnHome =  tool name: 'maven3', type: 'maven'   
      bat "${mvnHome}/bin/mvn package"
   }

 
  stage('Deploy to Tomcat'){
      
      sshagent(['tomcat-dev']) {
         sh 'scp -o StrictHostKeyChecking=no target/*.war ec2-user@13.234.76.1:/opt/tomcat9/webapps/'
      }
   }
   

   
}
